<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KuNime</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="home.css">
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js"></script>
  <script defer src="home.js"></script>
</head>
<body>
  <header class="navbar">
    <div class="logo">
      <img src="kunime-logo.png" alt="KuNime Logo" />
      <span>KuNime</span>
    </div>
    <div class="nav-right">
      <button class="search-btn" onclick="openSearchModal()"><i class="fas fa-search"></i></button>
      <!-- Profile icon button -->
      <button class="profile-btn" onclick="toggleLoginModal()">
        <i class="fas fa-user"></i> <!-- Person icon -->
      </button>
    </div>
  </header>

  <!-- Login/Signup Modal -->
  <div id="auth-modal" class="auth-modal">
    <div class="auth-modal-content">
      <span class="close" onclick="closeLoginModal()">&times;</span>
      <div id="auth-form">
        <h3 id="auth-header">Login</h3>
        <form id="login-form">
          <input type="email" id="login-email" placeholder="Email" required />
          <input type="password" id="login-password" placeholder="Password" required />
          <button type="button" onclick="logIn()">Login</button>
        </form>
        <form id="signup-form" style="display:none;">
          <input type="email" id="signup-email" placeholder="Email" required />
          <input type="password" id="signup-password" placeholder="Password" required />
          <button type="button" onclick="signUp()">Sign Up</button>
        </form>
        <button id="toggle-form-btn" onclick="toggleAuthForm()">Don't have an account? Sign up</button>
      </div>
    </div>
  </div>

  <section class="banner" id="banner">
    <div class="overlay">
      <h1 id="banner-title"></h1>
      <p id="banner-description"></p>
      <button class="play-btn" id="play-btn" onclick="goToMoviePage()">Play</button>
    </div>
  </section>

  <main class="container">
    <section class="row">
      <h2>ðŸŽ¬ Trending Movies</h2>
      <div class="list" id="movies-list"></div>
    </section>

    <section class="row">
      <h2>ðŸ“º Trending TV Shows</h2>
      <div class="list" id="tvshows-list"></div>
    </section>

    <section class="row">
      <h2>ðŸŽŒ Trending Anime</h2>
      <div class="list" id="anime-list"></div>
    </section>
  </main>

  <footer class="footer">
    <p>&copy; 2025 KuNime. All rights reserved.</p>
  </footer>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDzzvQfCB87RSgt654Vt0Zzx3-hz2kmwbA",
      authDomain: "kuuzzi-96589.firebaseapp.com",
      projectId: "kuuzzi-96589",
      storageBucket: "kuuzzi-96589.firebasestorage.app",
      messagingSenderId: "647877490795",
      appId: "1:647877490795:web:fd7dfb7316bc42e55a592e",
      measurementId: "G-1CJS32400R"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Sign-up function
    function signUp() {
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;

      auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
          const user = userCredential.user;
          alert('Sign-up successful! Welcome, ' + user.email);
          showUserInfo(user);
        })
        .catch(error => {
          const errorCode = error.code;
          const errorMessage = error.message;
          alert('Error: ' + errorMessage);
        });
    }

    // Log-in function
    function logIn() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          const user = userCredential.user;
          alert('Login successful! Welcome back, ' + user.email);
          showUserInfo(user);
        })
        .catch(error => {
          const errorCode = error.code;
          const errorMessage = error.message;
          alert('Error: ' + errorMessage);
        });
    }

    // Display user information after successful login
    function showUserInfo(user) {
      document.getElementById('sign-up-form').style.display = 'none';
      document.getElementById('login-form').style.display = 'none';
      document.getElementById('user-info').style.display = 'block';
      document.getElementById('user-name').textContent = user.email;
    }

    // Log-out function
    function logOut() {
      auth.signOut()
        .then(() => {
          alert('Logged out successfully');
          document.getElementById('user-info').style.display = 'none';
          document.getElementById('sign-up-form').style.display = 'block';
          document.getElementById('login-form').style.display = 'block';
        })
        .catch(error => {
          const errorCode = error.code;
          const errorMessage = error.message;
          alert('Error: ' + errorMessage);
        });
    }

    // Firebase Auth State change (detects user session)
    auth.onAuthStateChanged(user => {
      if (user) {
        showUserInfo(user);
      } else {
        document.getElementById('sign-up-form').style.display = 'block';
        document.getElementById('login-form').style.display = 'block';
      }
    });

    // Open login modal
    function toggleLoginModal() {
      const modal = document.getElementById('auth-modal');
      modal.style.display = 'flex';
    }

    // Close login modal
    function closeLoginModal() {
      const modal = document.getElementById('auth-modal');
      modal.style.display = 'none';
    }

    // Switch between login and signup forms
    function toggleAuthForm() {
      const signupForm = document.getElementById('signup-form');
      const loginForm = document.getElementById('login-form');
      const authHeader = document.getElementById('auth-header');
      const toggleBtn = document.getElementById('toggle-form-btn');

      if (signupForm.style.display === 'none') {
        signupForm.style.display = 'block';
        loginForm.style.display = 'none';
        authHeader.textContent = 'Sign Up';
        toggleBtn.textContent = 'Already have an account? Login';
      } else {
        signupForm.style.display = 'none';
        loginForm.style.display = 'block';
        authHeader.textContent = 'Login';
        toggleBtn.textContent = 'Don\'t have an account? Sign up';
      }
    }
  </script>
</body>
</html>
