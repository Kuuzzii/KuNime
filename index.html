<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KuNime</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="home.css">
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js"></script>
  <script defer src="home.js"></script>
</head>
<body>
  <header class="navbar">
    <div class="logo">
      <img src="kunime-logo.png" alt="KuNime Logo" />
      <span>KuNime</span>
    </div>
    <div class="nav-right">
      <button class="search-btn" onclick="openSearchModal()"><i class="fas fa-search"></i></button>
    </div>
  </header>

  <section class="banner" id="banner">
    <div class="overlay">
      <h1 id="banner-title"></h1>
      <p id="banner-description"></p>
      <button class="play-btn" id="play-btn" onclick="goToMoviePage()">Play</button>
    </div>
  </section>

  <main class="container">
    <section class="row">
      <h2>ðŸŽ¬ Trending Movies</h2>
      <div class="list" id="movies-list"></div>
    </section>

    <section class="row">
      <h2>ðŸ“º Trending TV Shows</h2>
      <div class="list" id="tvshows-list"></div>
    </section>

    <section class="row">
      <h2>ðŸŽŒ Trending Anime</h2>
      <div class="list" id="anime-list"></div>
    </section>
  </main>

  <!-- Sign-up Form -->
  <div id="sign-up-form">
    <h2>Sign Up</h2>
    <input type="email" id="signup-email" placeholder="Enter your email" required>
    <input type="password" id="signup-password" placeholder="Enter your password" required>
    <button onclick="signUp()">Sign Up</button>
  </div>

  <!-- Log-in Form -->
  <div id="login-form">
    <h2>Log In</h2>
    <input type="email" id="login-email" placeholder="Enter your email" required>
    <input type="password" id="login-password" placeholder="Enter your password" required>
    <button onclick="logIn()">Log In</button>
  </div>

  <!-- User Info Section (After Login) -->
  <div id="user-info" style="display: none;">
    <h3>Welcome, <span id="user-name"></span></h3>
    <button onclick="logOut()">Log Out</button>
  </div>

  <div class="modal" id="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <div class="modal-body">
        <img id="modal-image" src="" alt="Poster" />
        <div class="modal-text">
          <h2 id="modal-title"></h2>
          <div class="stars" id="modal-rating"></div>
          <p id="modal-description"></p>
          <div class="server-selector">
            <label for="server">Server:</label>
            <select id="server" onchange="changeServer()">
              <option value="vidsrc.cc">Vidsrc.cc</option>
              <option value="vidsrc.me">Vidsrc.me</option>
              <option value="player.videasy.net">Player.Videasy.net</option>
            </select>
          </div>
        </div>
      </div>
      <div class="video-wrapper">
        <iframe id="modal-video" frameborder="0" allowfullscreen></iframe>
      </div>
    </div>
  </div>

  <div class="search-modal" id="search-modal">
    <span class="close" onclick="closeSearchModal()">&times;</span>
    <input type="text" id="search-input" placeholder="Search for movies or shows..." oninput="searchTMDB()" />
    <div class="results" id="search-results"></div>
  </div>

  <footer class="footer">
    <p>&copy; 2025 KuNime. All rights reserved.</p>
    <div class="footer-links">
      <a href="#">Disclaimer</a>
      <a href="#">About</a>
      <a href="#">Contact</a>
    </div>
  </footer>

  <script>
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDzzvQfCB87RSgt654Vt0Zzx3-hz2kmwbA",
      authDomain: "kuuzzi-96589.firebaseapp.com",
      projectId: "kuuzzi-96589",
      storageBucket: "kuuzzi-96589.firebasestorage.app",
      messagingSenderId: "647877490795",
      appId: "1:647877490795:web:fd7dfb7316bc42e55a592e",
      measurementId: "G-1CJS32400R"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Sign-up function
    function signUp() {
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;

      auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
          const user = userCredential.user;
          alert('Sign-up successful! Welcome, ' + user.email);
          showUserInfo(user);
        })
        .catch(error => {
          const errorCode = error.code;
          const errorMessage = error.message;
          alert('Error: ' + errorMessage);
        });
    }

    // Log-in function
    function logIn() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          const user = userCredential.user;
          alert('Login successful! Welcome back, ' + user.email);
          showUserInfo(user);
        })
        .catch(error => {
          const errorCode = error.code;
          const errorMessage = error.message;
          alert('Error: ' + errorMessage);
        });
    }

    // Display user information after successful login
    function showUserInfo(user) {
      document.getElementById('sign-up-form').style.display = 'none';
      document.getElementById('login-form').style.display = 'none';
      document.getElementById('user-info').style.display = 'block';
      document.getElementById('user-name').textContent = user.email;
    }

    // Log-out function
    function logOut() {
      auth.signOut()
        .then(() => {
          alert('Logged out successfully');
          document.getElementById('user-info').style.display = 'none';
          document.getElementById('sign-up-form').style.display = 'block';
          document.getElementById('login-form').style.display = 'block';
        })
        .catch(error => {
          const errorCode = error.code;
          const errorMessage = error.message;
          alert('Error: ' + errorMessage);
        });
    }

    // Firebase Auth State change (detects user session)
    auth.onAuthStateChanged(user => {
      if (user) {
        showUserInfo(user);
      } else {
        document.getElementById('sign-up-form').style.display = 'block';
        document.getElementById('login-form').style.display = 'block';
      }
    });
  </script>
</body>
</html>
